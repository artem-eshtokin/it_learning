# ДЗ Python

"Для выполнения задания потребуется самому сгенерировать данные с помощью модуля random (все пункты выполняются с помощью нее).

Что необходимо, для создания будущей таблицы:

0) Для генерации данных в random необходимо установить seed = "АДВИ_2023", длина каждого списка N = 1000;
1) index колонка: создать список из N последовательных целых элементов от 1 до 1000 включительно, далее, с помощью специальной функции random перемешать его;
2) groups колонка: создать список из N элементов, состоящий из значений из списка ["группа_1", "группа_2", "группа_3", "группа_4", "группа_5"], необходимо использовать функцию из random которая возвращает список элементов длины k, выбранных из последовательности population с перестановкой элементов;
3) uniform колонка: создать список из N элементов, состоящий из целых значение из равномерного распределения [50, 100] ;
4) gauss_1, gauss_2, gauss_3 колонки: Создать 3 списка из N элементов каждый, заполненные значениями из нормальных распределений с параметрами:
μ = 0, σ^2 = 1 -> третья колонка gauss_1;
μ = 0, σ^2 = 144 -> четвертая колонка gauss_2;
μ = 50, σ^2 = 81 -> пятая колонка gauss_3;
5) Создать pandas DataFrame, где (1) будет индексом, (2)-(4) колонки, названия колонок ["groups", "uniform", "gauss_1", "gauss_2", "gauss_3"] соответственно, не забывая проверить, что типы колонок должны соответствовать заявленным типам данных;
6) Для колонок gauss_1 и gauss_2 заменить значения на None:
Для gauss_1, если индекс у значение делится на 121 без остатка;
Для gauss_2, если дробная часть больше 0.95;
7) Теперь, для пропущенных значений gauss_1 и gauss_2:
Для gauss_2 None заменить на среднее по колонке;
Удалить строчки из таблицы, где gauss_1 == None.

Первая строка из таблицы для сверки:
|index|groups|uniform|gauss_1|gauss_2| gauss_3|
|476|группа_1|95|3.010291|2.156346|57.455853|"

## Решение теста

import random
import pandas as pd
import numpy as np
import math

random.seed("АДВИ_2023")

N = 1000
ints_col = list(range(1, N + 1))
random.shuffle(ints_col)

groups = ["группа_1", "группа_2", "группа_3", "группа_4", "группа_5"]
groups_col = random.choices(groups, k=N)
uniform_col = [random.randint(50, 100) for i in range(N)]

gauss_1_col = [random.gauss(0, 1) for i in range(N)]
gauss_2_col = [random.gauss(0, 12) for i in range(N)]
gauss_3_col = [random.gauss(50, 9) for i in range(N)]

cols = ["groups_col", "uniform_col", "gauss_1_col", "gauss_2_col", "gauss_3_col"]
df = pd.DataFrame(
    data=np.array([groups_col, uniform_col, gauss_1_col, gauss_2_col, gauss_3_col]).T,
    index=ints_col,
    columns=cols,
    )

df.uniform_col = df.uniform_col.astype(int)
df[["gauss_1_col", "gauss_2_col", "gauss_3_col"]] = df[["gauss_1_col", "gauss_2_col", "gauss_3_col"]].astype(np.float32)

df.loc[[121 * i for i in range(1, 9)], "gauss_1_col"] = None
df.gauss_2_col = df.gauss_2_col.apply(lambda x: None if (x - math.floor(x)) > 0.95 else x)

df.gauss_2_col.fillna(df.gauss_2_col.mean(), inplace=True)
df.dropna(inplace=True)

pd.set_option("display.precision", 2)

1. Сколько всего получилось записей в таблице после выполнения всех пунктов из условия?
- 992

print(df.shape)

2. Для колонки gauss_2 посчитать среднее и среднеквадратическое отклонение.
Результаты необходимо написать в одну ячейку, разделенные пробелом, сначала среднее потом среднеквадратическое отклонение. Результаты округлить до сотых. Для дробной части использовать точку, как разделитель.
- -0.47 12.07

print(df.describe().loc[["mean", "std"], "gauss_2_col"])

3. Какая группа встречается чаще всего и сколько раз? Сначала вывести название группы, через пробел указать целое число.
- группа_4 222

print(df.groups_col.value_counts()[:1])

4. Для группа_5 вывести самый "ранний" (наименьший) индекс.
- 6

print(df[df.groups_col == "группа_5"].sort_index().index[0])

5. Сколько записей из колонки uniform имеют значение не ниже значения 90% перцентиля?
- 118

print(df[df.uniform_col >= df.uniform_col.quantile(0.9)].shape[0])

6. У какой группы наибольшее значение медианы для gauss_3? Вывести это значение вместе с группой. Сначала группа, через пробел значение медианы (результат округлить до сотых , для дробной части использовать точку, как разделитель)
- группа_2 49.99

print(df.groupby("groups_col").median().sort_values("gauss_3_col", ascending=False)[:1]["gauss_3_col"])

7. У какой группы наибольшее минимальное значение uniform? Если такого нет, выбрать группу наибольшим минимальным значением в gauss_1. Ответ дать в виде группы, через пробел указать значение в gauss_2 с аналогичной агрегацией (результат округлить до сотых, для дробной части использовать точку, как разделитель)
- группа_3 -36.19

print(df.groupby("groups_col").min().sort_values("gauss_1_col", ascending=False)[:1]["gauss_2_col"])

8. Создать новую колонку gauss где значения будут получаться из (gauss_1 + gauss_2) / gauss_3 Чему будет равен 70% перцентиль (результат округлить до сотых, для дробной части использовать точку, как разделитель)?
- 0.11

print(((df.gauss_1_col + df.gauss_2_col) / df.gauss_3_col).quantile(0.70))